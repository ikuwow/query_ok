---
title: PHP5.3.3からPHP 5.6.7にアップデートする際にやったこと
date: 2015-03-31 12:24 JST
tags: PHP
published: false
---

PHP 5.3.3から現在最新のPHP5.6.7にアップデートする機会があったのでその時のメモ。

Cent OSで`yum install php`をすると、既にサポートが1年近く前に切れているPHP 5.3.3が
インストールされてしまう。このコマンドは既に絶対に打ってはいけないコマンドになってしまった。

なんとサービスの動いているサーバーのPHPのバージョンが5.3.3で、既にサポートも切れて


## サーバー側の変更

サーバーにインストールされているPHPのアップデートそのものの作業は特に複雑な部分はない。

基本的にソースからビルドすることを前提。

まず今インストールされているPHPのコンパイルオプションを確認し、

## アプリケーション側の変更

今回は5.3から5.6というかなり間をすっ飛ばしたアップデートの仕方をするので、
アプリケーション側で確認すべきことは多い。

5.3 => 5.4、5.4 => 5.5、5.5 => 5.6のそれぞれについての後方互換性のない変更を確認する必要がある。

* http://php.net/manual/ja/migration54.php
* http://php.net/manual/ja/migration55.php
* http://php.net/manual/ja/migration56.php

この中で特に注意したものを挙げる。

### 参照渡しの利用方法の変化 (PHP5.3 => PHP5.4)

関数呼び出し時に参照渡しが指定されている場合Fatal Errorが発生する。
これは絶対に確認する必要がある。




ただSyntax Errorなので、以下のように全ファイルに文法チェックを行えば簡単に確認できる。

```
$ find /path/to/app -name *.php -exec php -l {} \;
```

また変化も画一的なので、動作を確認しなくてもコードベースで修正が可能。

### 
